{% extends "form.html" %}
{% block content %}
    <div class="page-container">
        <!-- Page Title -->
        <h1 class="page-title">Upload Email</h1>
        
        <!-- Upload Form Section -->
        <div class="content-section">
            <div id="uploadForm"> <!-- Before Uploade -->
                <h3 class="section-header">Upload .eml File</h3>
                <div class="placeholder-content">
                    <p class="placeholder-text">Select an email file to analyze for phishing threats</p>
                    <form method="post" enctype="multipart/form-data" action="/upload">

                        <div id="uploadControls" class="mb-3 form-check">
                            <input type="file" class="form-control" name="file" accept=".eml" id="dropBox" multiple required/>
                            
                            <!-- Selected files preview -->
                            <div id="selectedFiles" class="mt-2"></div>
                        </div>

                         <!-- Div for error messages before submit -->
                        <div id="SubmitError"></div>
                        
                        <button type="submit" id="submitButton" class="btn btn-primary">Submit</button>

                    </form>
                </div>
            </div>
            <!-- Analysis Section - After Submit -->
            <div id="analysis" class="hidden">
                <div class="section-header">
                    <h3>Analyzing Your Email</h3>
                    <button id="ToUpload" type="reset" class="btn btn-secondary">
                        <i class="bi bi-arrow-left"></i> Back
                    </button>
                </div>
                
                <div class="analysis-section">
                    
                    <!-- Loading Spinner -->
                    <div id="loadingSpinner" class="text-center my-4">
                        <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-3 text-muted">Please wait while we analyze your email for phishing threats...</p>
                    </div>
                    
                    <!-- Results Container -->
                    <div id="result"></div>
                    
                    <!-- Download Button -->
                    <div id="downloadSection" class="text-center mt-4 hidden">
                        <button type="button" id="downloadButton" class="btn btn-success btn-lg">
                            <i class="bi bi-download"></i> Download Report
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
